<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ORIGIN CLIENT</title>
  <link rel="stylesheet" href="mc-ten-lowercase-alt.ttf">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    @font-face {
      font-family: 'MCFont';
      src: url('mc-ten-lowercase-alt.ttf');
    }

    body {
      margin: 0;
      font-family: 'MCFont', sans-serif;
      background-color: #f4f4f4;
    }

    header {
      background-color: black;
      color: white;
      text-align: center;
      padding: 10px 0;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
    }

    header h1, header h2 {
      margin: 0;
      line-height: 1.2;
    }

    header h1 {
      font-size: 32px;
    }

    header h2 {
      font-size: 16px;
    }

    main {
      padding: 100px 20px 40px;
      max-width: 800px;
      margin: auto;
    }

    select, input[type="text"] {
      padding: 8px;
      margin-top: 10px;
      width: 100%;
      max-width: 300px;
      display: block;
      font-family: 'MCFont', sans-serif;
    }

    .frame-section {
      background: #fff;
      padding: 15px;
      border: 1px solid #ccc;
      margin-top: 20px;
      position: relative;
    }

    .frame-section h3 {
      margin: 0 0 10px 0;
    }

    .frame-controls {
      margin-bottom: 10px;
    }

    .image-preview {
      display: block;
      max-height: 60px;
      margin-top: 5px;
    }

    button {
      font-family: 'MCFont', sans-serif;
    }

    .toast {
      display: none;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #ff4d4d;
      color: white;
      padding: 10px 15px;
      border-radius: 4px;
      z-index: 9999;
    }

    .toast button {
      background: none;
      border: none;
      color: white;
      font-size: 16px;
      margin-left: 10px;
      cursor: pointer;
    }

    #downloadAll {
      margin-top: 40px;
      padding: 10px 20px;
      background-color: black;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <h1>ORIGIN CLIENT</h1>
    <h2>-animated items maker-</h2>
  </header>
  <main>
    <label><strong>Add your texture:</strong></label>
    <select id="itemSelector">
      <option value="none" selected disabled>Select an item</option>
      <option value="diamond_sword">diamond_sword</option>
      <option value="netherite_sword">netherite_sword</option>
      <option value="totem_of_undying">totem_of_undying</option>
      <option value="netherite_axe">netherite_axe</option>
      <option value="diamond_axe">diamond_axe</option>
      <option value="netherite_pickaxe">netherite_pickaxe</option>
      <option value="diamond_pickaxe">diamond_pickaxe</option>
    </select>

    <label for="packName"><strong>Pack Name:</strong></label>
    <input type="text" id="packName" placeholder="Enter pack name...">

    <div id="itemsContainer"></div>
    <button id="downloadAll">Download All</button>

    <div id="toast" class="toast">
      <span id="toastMessage"></span>
      <button id="closeToast">&times;</button>
    </div>
  </main>

  <script>
    const itemCodes = {
      diamond_sword: 'ds',
      netherite_sword: 'ns',
      totem_of_undying: 't',
      netherite_axe: 'na',
      diamond_axe: 'da',
      netherite_pickaxe: 'np',
      diamond_pickaxe: 'dp'
    };

    const createdItems = new Set();

    document.getElementById('itemSelector').addEventListener('change', function () {
      const item = this.value;
      if (createdItems.has(item)) return;
      createdItems.add(item);

      const container = document.getElementById('itemsContainer');
      const section = document.createElement('div');
      section.className = 'frame-section';
      section.id = `${item}_section`;

      let html = `<h3>Item name: ${item} <button onclick="removeItem('${item}')">&times;</button></h3>`;
      for (let i = 1; i <= 10; i++) {
        html += `
          <div class="frame-controls">
            <label>Add frame ${i}:</label>
            <input type="file" accept="image/*" id="${item}_frame_${i}" onchange="previewImage(event, '${item}_frame_${i}_img')">
            <img id="${item}_frame_${i}_img" class="image-preview" />
          </div>
        `;
      }
      section.innerHTML = html;
      container.appendChild(section);
    });

    function removeItem(item) {
      document.getElementById(`${item}_section`).remove();
      createdItems.delete(item);
      document.getElementById('toast').style.display = 'none';
    }

    function previewImage(event, imgId) {
      const img = document.getElementById(imgId);
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => (img.src = reader.result);
        reader.readAsDataURL(file);
      }
    }

    document.getElementById('downloadAll').addEventListener('click', async () => {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      toast.style.display = 'none';
      toastMessage.textContent = '';

      const packName = document.getElementById('packName').value.trim();
      if (!packName) {
        showToast('Error: Please enter a pack name');
        return;
      }

      if (createdItems.size === 0) {
        showToast('error:file_empty');
        return;
      }

      const zip = new JSZip();
      let hasError = false;
      let errorMessages = [];

      for (let item of createdItems) {
        const code = itemCodes[item];
        const folder = zip.folder('textures').folder(item);
        for (let i = 1; i <= 10; i++) {
          const input = document.getElementById(`${item}_frame_${i}`);
          if (input && input.files.length) {
            const file = input.files[0];
            const fileData = await file.arrayBuffer();
            folder.file(`${code}${i}.png`, fileData);
          } else {
            hasError = true;
            errorMessages.push(`error:${item}:frame_${i} texture not available`);
          }
        }
      }

      if (hasError) {
        showToast(errorMessages.join('\n'));
        return;
      }

      zip.generateAsync({ type: 'blob' }).then(content => {
        saveAs(content, `${packName}.mcpack`);
      });
    });

    function showToast(message) {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      toastMessage.textContent = message;
      toast.style.display = 'block';
    }

    document.getElementById('closeToast').addEventListener('click', () => {
      document.getElementById('toast').style.display = 'none';
    });
  </script>
</body>
</html>
